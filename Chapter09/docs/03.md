# 3. 애플리케이션 아키텍처

- 클라이언트와 백엔드 시스템 종류, 사용 기술, 연동 방법을 결정했다면 시스템 레벨 아키텍처는 대략 구성됐다.
- 다음으로 결정할 사항은 **스프링 웹 애플리케이션의 아키텍처**다.
- 아키텍처란 단순한 정의로는 **어떤 경계 안에 있는 내부 구성요소가 어떤 책임을 갖고 있고, 어떤 방식으로 서로 관계를 맺고 동작하는지를 규정하는 것**이다.
  
## 3.1 계층형 아키텍처

- 성격이 다른 모듈이 강하게 결합되어 있으면 한 가지로 이유로 변경이 일어날 때 상관 없는 요소도 영향을 받는다.
- 따라서 인터페이스와 같은 유연한 경계를 만들고 분리하거나 모아주는 작업이 필요하다.

### 아키텍처와 SoC

- 지금까지는 DI 컨테이너를 통해 오브젝트끼리 직접적인 관계를 맺지 못하게 유연한 설계와 구현 전략을 사용하였다.
- 이런 원리는 아키텍처 레벨에서 좀 더 큰 단위에도 동일하게 적용할 수 있다.
- 애플리케이션을 구성하는 오브젝트를 비슷한 성격과 책임을 가진 것끼리 묶을 수 있다.
    - 예를 들면 데이터 액세스 로직을 담당하는 DAO
    - 혹은 비즈니스 로직을 구현해놓은 비즈니스 서비스 오브젝트
- 이렇게 분리한 각 오브젝트는 독자적으로 개발과 테스트가 가능하다.
- 또한 전체를 이해하기도 상대적으로 쉽다.
- 이렇게 책임과 성격이 다른 것을 크게 그룹을 만들어 분리하는 것을 **계층형 아키텍처(layered architecture)**라 한다.
- 또는 계층이라는 의미를 가진 티어(tier)를 사용하여 **멀티 티어 아키텍처**라 한다.
- 보통 웹 기반 엔터프라이즈 애플리케이션은 일반적으로 세 개의 계층을 가지므로 **3계층(3-tier 또는 3-layer) 애플리케이션**이라 한다.

### 3계층 아키텍처와 수직 계층

1. 데이터 액세스 계층
    - 데이터 액세스 계층은 DAO 계층이라고도 불린다. DAO 패턴을 보편적으로 사용하기 때문이다.
    - 또한 DB 외에도 ERP, 레거시 시스템, 메인프레임 등에 접근하는 역할을 하여 **EIS(Enterprise Information System) 계층**이라고도 한다.
    - 외부 시스템을 호출해서 서비스를 이용하는 것은 기반(infrastructure) 계층으로 분류하기도 한다.
    - 사용 기술에 따라 다시 세분화된 계층으로 구분된다.
    - 추상화 수준에 따른 구분이기 떄문에 수직적 계층이라 부르기도 한다.
    - `JdbcTemplate`을 사용하는 데이터 액세스 계층의 특징은 `JdbcTemplate`이 추상화를 위한 계층으로 사용돼 로우레벨 기반 계층에 존재하는 기능을 간접적으로 이용하게 만든다.
    - 추상화 계층은 필요하면 얼마든지 추가할 수 있는데, 새로운 추상 계층을 도입해 하위 계층의 종류가 다른 서비스를 일관된 방식으로 접근할 수 있게 하는 구조다.
    - 새로운 계층을 추가하면 코드에 지대한 영ㄹ향을 주기 때문에 신중해야 한다.
2. 서비스 계층
    - 잘 만들어진 스프링 애플리케이션의 서비스 계층 클래스는 이상적인 POJO로 작성된다.
    - 이는 객체지향적인 설계 기법이 적용된 코드를 통해 비즈니스 로직의 핵심을 담아내고, 쉽게 테스트하고 유연하게 확장할 수 있다.
    - 서비스 계층은 DAO 계층을 호출하고 이를 활용해서 만들어진다.
    - 때론 데이터 액세스를 위한 기능 외에 서버나 시스템 레벨에서 제공하는 기반 서비스를 활용할 필요도 있다.
    - 서비스 계층은 특별한 경우가 아니면 추상화 수직 계층구조를 가질 필요가 없다.
    - 비즈니스 로직을 담은 **서비스 계층**과 엔터프라이즈 서비스를 제공하는 **기반 서비스 계층**은 혼동되기 쉬우니 주의해야 한다.
    - 기반 서비스 계층은 3계층 어디에서나 접근이 가능한 구조로 설정할 수 있다.
    - 스케쥴링이 필요한 경우는 기반 서비스 계층이 서비스 계층을 실행하는 경우도 있다.
    - 원칙적으로 서비스 계층이 기반 서비스 계층의 구현에 종속되면 안 된다.
    - 이상적인 서비스 계층은 데이터 액세스 계층이나 프레젠테이션 계층이 바뀌어도 그대로 유지되어야 한다.
3. 프레젠테이션 계층
    - 가장 복잡한 계층이며, 매우 다양한 기술과 프레임워크 조합을 가질 수 있다.
    - 따라서 프레젠테이션에서 사용할 기술과 구조를 선택하는 일은 간단하지 않다.
    - 엔터프라이즈 애플리케이션에서는 클라이언트 종류와 상관 없이 HTTP 프로토콜을 사용하는 서블릿이 바탕이 된다.
    - 스프링은 웹 기반 프레젠테이션 계층을 개발할 수 있는 전용 프레임워크를 제공한다.

---
[Home](./index.md)
