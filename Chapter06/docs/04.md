# 4. 스프링의 프록시 팩토리 빈

## 4.1 ProxyFactoryBean

- 스프링은 프록시 오브젝트를 생성해주는 기술을 추상화한 팩토리 빈을 제공한다.
- `ProxyFactoryBean`은 순수하게 프록시를 생성하는 작업만 담당하고 프록시를 통해 제공해줄 부가기능은 별도의 빈에 둘 수 있다.
- `ProxyFactoryBean`이 생성할 부가기능은 `MethodInterceptor` 인터페이스를 구현해 만든다.
- `MethodInterceptor`는 `InvocationHandler`와 유사하지만 `invoke()` 메서드에서 타깃 오브젝트에 대한 정보도 함께 제공 받는다.
- 이 차이는 `MethodInterceptor`가 타깃 오브젝트에 상관 없이 독립적으로 만들어질 수 있게 한다.

```java
public class DynamicProxyTest {
    // ...

    @Test
    public void proxyFactoryBean() {
        ProxyFactoryBean pfBean = new ProxyFactoryBean();
        pfBean.setTarget(new HelloTarget());
        pfBean.addAdvice(new UppercaseAdvice());

        Hello proxiedHello = (Hello) pfBean.getObject();

        assertThat(proxiedHello.sayHello("Toby"), is("HELLO TOBY"));
        assertThat(proxiedHello.sayHi("Toby"), is("HI TOBY"));
        assertThat(proxiedHello.sayThankYou("Toby"), is("THANK YOU TOBY"));
    }

    private class UppercaseAdvice implements MethodInterceptor {
        @Override
        public Object invoke(MethodInvocation methodInvocation) throws Throwable {
            String ret = (String)methodInvocation.proceed();
            return ret.toUpperCase();
        }
    }

    // ...
}
```

---
[목록](./index.md)
