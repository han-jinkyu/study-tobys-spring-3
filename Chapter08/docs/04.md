# 4. 스프링의 기술

- 스프링은 POJO 프로그래밍을 손쉽게 할 수 있도록 지원하는 세 가지 가능기술(enabling technology)을 제공한다.
    - 세 가지 가능기술은 IoC/DI, AOP, PSA다.
- 스프링 사용자라면 스프링이 직접 제공하지 않는 기술에 대해서도 PSA를 적용할 줄 알아야 한다.


## 4.1 제어의 역전(IoC) / 의존관계 주입(DI)

- 왜 두 개의 오브젝트를 분리해 만들고, 인터페이스를 두어 느슨하게 연결한 뒤, DI를 통해 외부에서 지정하는 것인가?
    - 가장 간단한 답변은 **유연한 확장이 가능하게 하기 위해서**다.
- DI는 개방 폐쇄 원칙으로 잘 설명된다.
    - 유연한 확장이라는 장점은 '확장에는 열려 있다'에 해당한다.
    - 폐쇄 관점에서 보는 장점은 '재사용이 가능하다'에 해당한다.
    
### DI의 활용 방법

1. 핵심기능의 변경
    - DI의 가장 대표적인 적용 방법은 **의존 대상의 구현을 바꾸는 것**이다.
    - **디자인 전략 패턴**이 대표적인 예다.
2. 핵심기능의 동적인 변경
    - 또 다른 활용 방법은 **의존 오브젝트의 핵심기능 자체를 바꾸는 것**이다.
    - 동적으로 매번 다르게 변경할 수 있다.
3. 부가기능의 추가
    - 세 번째 활용 방법은 **핵심기능은 그대로 둔 채로 부가기능을 추가하는 것**이다.
    - **데코레이터 패턴**을 생각할 수 있다.
4. 인터페이스의 변경
    - **클라이언트가 사용하는 인터페이스와 실제 오브젝트 사이에 인터페이스가 일치하지 않는 경우**에도 유용하다.
    - 디자인 패턴에서 말하는 오브젝트 방식의 **어댑터 패턴의 응용**이다.
    - 일관성 있는 서비스 추상화(PSA) 같이 중간에 인터페이스 어댑터 역할을 해주는 레이어를 하나 추가하는 방법도 있다.
5. 프록시
    - 프록시 패턴의 전형적인 응용 방법도 있다.
    - 지연된 로딩(lazy loading)이나 원격 프록시를 적용할 때 프록시가 필요하다.
6. 템플릿과 콜백
    - 반복적/고정적인 작업 사이에 변화하는 부분을 분리해 템플릿과 콜백으로 만드록 이를 DI 원리로 간결하게 할 수 있다.
    - 콜백은 개방을 통한 유연한 확장성을 보여주며, 템플릿은 재사용할 수 있다는 점에서 폐쇄를 보여준다.
7. 싱글톤과 오브젝트 스코프
    - DI가 필요한 이유 중 중요한 한 가지는 **DI 할 오브젝트의 생명주기를 제어**할 수 있다는 것이다.
    - 싱글톤 외에도 다양한 스코프를 갖을 수 있다.
8. 테스트
    - 여타 오브젝트와 협력해서 동작하는 오브젝트를 효과적으로 테스트하는 방법은 고립시키는 것이다.
    - 따라서 의존 오브젝트를 목 오브젝트 같은 대역을 활용해야 한다.
    - 이때 테스트 코드 안에 수동으로 목 오브젝트를 주입하거나 할 수 있다.

---
[Home](./index.md)
